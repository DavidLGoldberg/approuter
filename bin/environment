#! /usr/bin/env bash
ROOT=`pwd`
MANAGED_ROOT=`pwd`/managed
CONF_ROOT=${ROOT}/etc
ALTERNATES_ROOT=${MANAGED_ROOT}/alternates
VAR_DIR=${MANAGED_ROOT}/var
LOG_DIR=${VAR_DIR}/log
RUN_DIR=${VAR_DIR}/run
RUNTIME_BIN_DIR=${VAR_DIR}/bin
RUN_DATA_FILE=${VAR_DIR}/run_data
REPO_CONF=${CONF_ROOT}/repo.conf
START_CMD_TEMPLATE=`cat ${CONF_ROOT}/starter.conf`
ALTERNATES_CONF=${CONF_ROOT}/alternates.conf
GENERATED_CONF_DIR=${VAR_DIR}/conf
ALTERNATE_ROUTE_COOKIE_PREFIX=arcp
NGINX_CONF_ROOT=${GENERATED_CONF_DIR}/nginx
NGINX_CONF_FILE=${GENERATED_CONF_DIR}/nginx/nginx.conf
NGINX_CONF_TEMPLATE=`pwd`/templates/nginx.conf

mkdir -p ${GENERATED_CONF_DIR}
mkdir -p ${NGINX_CONF_ROOT}
mkdir -p ${RUNTIME_BIN_DIR}

function set_instance_name_from_dir(){
  INSTANCE_DIR=$1
  INSTANCE_NAME=`basename $1`
}

function set_instance_start_control_file_path(){
  INSTANCE_PATH=$1
  START_CTL_FILE=${RUNTIME_BIN_DIR}/start_${INSTANCE_NAME}
}

function set_instance_stop_control_file_path(){
  INSTANCE_PATH=$1
  STOP_CTL_FILE=${RUNTIME_BIN_DIR}/stop_${INSTANCE_NAME}
}
export -f set_instance_name_from_dir
export -f set_instance_start_control_file_path
export -f set_instance_stop_control_file_path

